

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HPLC Processing &amp; Analysis &mdash; cremerlab-utils 0.0.01 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Documentation for cremerlab-utils" href="../index.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../index.html">
                cremerlab-utils
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../index.html">Docs</a></li>
        
      <li>HPLC Processing &amp; Analysis</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../_sources/source/HPLC_processing.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">HPLC Processing &amp; Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Setting-Up-Your-HPLC-Run">Setting Up Your HPLC Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ASCII-File-Conversion">ASCII File Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Quantifying-Peaks">Quantifying Peaks</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="HPLC-Processing-&amp;-Analysis">
<h1>HPLC Processing &amp; Analysis<a class="headerlink" href="#HPLC-Processing-&-Analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Permalink to this headline">¶</a></h2>
<p><strong>H</strong>igh-<strong>P</strong>erformance <strong>L</strong>iquid <strong>C</strong>hromatography (HPLC) is an analytical technique which allows for the quantitative characterization of the components of a mixture. In the lab, we typically use this this to quantify the turnover of sugars and organic acids such as glucose and acetate. While many of the technical details of HPLC are now automated, the programmatic cleaning and processing of the resulting data can be cumbersome.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc</span></code> module is written to allevieate some of this burden, making the actual running of the HPLC the most time consuming part of the analysis. The rest of this page will show you how to use the <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc</span></code> module to convert the ASCII data output from our Shimadzu HPLC to a useable format and how to quantify the abundance of the relevant peaks</p>
</div>
<div class="section" id="Setting-Up-Your-HPLC-Run">
<h2>Setting Up Your HPLC Run<a class="headerlink" href="#Setting-Up-Your-HPLC-Run" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="ASCII-File-Conversion">
<h2>ASCII File Conversion<a class="headerlink" href="#ASCII-File-Conversion" title="Permalink to this headline">¶</a></h2>
<p>Given a configuration like that shown above, the data will be saved in two formats. The first is a proprietary format (with the extension <code class="docutils literal notranslate"><span class="pre">.lcd</span></code>) but the other is an ASCII text document (with the extension <code class="docutils literal notranslate"><span class="pre">.txt</span></code>). The latter document, will have all of the metadata associated with the HPLC run as well as the underlying chromatogram for each detector.</p>
<p>The ASCII document is formatted such that its (mostly) human readable, but difficult to read programmatically. Furthermore, the file is named in an unclear way, making it difficult to tell what data corresponds to what sample. Luckily, the <code class="docutils literal notranslate"><span class="pre">.txt</span></code> document will have all of the metadata we need to know to map the file to the sample ID we defined when setting up the HPLC run in the previous section. The first sixty or so lines of a representative <code class="docutils literal notranslate"><span class="pre">.txt</span></code> file is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1: [Header]
2: Application Name,LabSolutions
3: Version,5.97 SP1
4: Data File Name,
5: C:\Users\cremerlab\Desktop\griffin\2021-03-17_REL606_NCM3722_turnover\batch_3172021_004_009.lcd
6: Output Date,3/17/2021
7: Output Time,9:36:36 PM
8:
9: [File Information]
10: Type,Data File
11: Generated,3/17/2021 8:51:17 PM
12: Generated by,System Administrator
13: Modified,3/17/2021 9:36:36 PM
14: Modified by,System Administrator
15:
16: [Sample Information]
17: Operator Name,System Administrator
18: Acquired,3/17/2021 8:51:35 PM
19: Sample Type,1:Standard
20: Level,4
21: Sample Name,2021-03-17_NCM3722_NC_sample004
22: Sample ID,004
...
55: Dilution Factor,1
56: Vial#,31
57: Injection Volume,20
</pre></div>
</div>
<p>We can see that information about the sample name, acquisition date, sample ID, and vial number is buried in the the metadata. Further down in the file, we have the actual data of the chromatogram,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>77: [LC Chromatogram(Detector B-Ch1)]
78: Interval(msec),500
79: # of Points,5401
80: Start Time(min),0.000
81: End Time(min),45.000
82: Intensity Units,mV
83: Intensity Multiplier,0.001
84: R.Time (min),Intensity
85: 0.00000,-5
86: 0.00833,-5
87: 0.01667,0
</pre></div>
</div>
<p>with some more metadata about the detector settings. While we could manually piece together the information for each file, the <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc</span></code> module has this ability built in. We can start by loading in the <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc</span></code> module and defining the path to our target file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the os module to show file directory structures</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Import the cremerlab module</span>
<span class="kn">import</span> <span class="nn">cremerlab.hplc</span>

<span class="c1"># Define the path to the file.</span>
<span class="n">file</span> <span class="o">=</span><span class="s1">&#39;data/2021-03-17_008.txt&#39;</span>
</pre></div>
</div>
</div>
<p>Above, we specified the relative path of the datafile we wish to convert. Right now, this is the only file in the directory:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;out&#39;, &#39;2021-03-17_008.txt&#39;]
</pre></div></div>
</div>
<p>To read in that file, get the metadata, and save the chromatogram, we can call the function <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc.convert</span></code> on this path.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert the file specified by the path</span>
<span class="n">cremerlab</span><span class="o">.</span><span class="n">hplc</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
File(s) successfully converted!
</pre></div></div>
</div>
<p>We get a message that the conversion was successful. Now, if we look at that same <code class="docutils literal notranslate"><span class="pre">data</span></code> directory, we see a new subdirectory <code class="docutils literal notranslate"><span class="pre">out/</span></code> along with the original file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;out&#39;, &#39;2021-03-17_008.txt&#39;]
</pre></div></div>
</div>
<p>In that <code class="docutils literal notranslate"><span class="pre">out/</span></code> subdirectory is the converted file saved as a <code class="docutils literal notranslate"><span class="pre">.csv</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data/out/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;2021-03-17_NCM3722_NC_sample004.csv&#39;]
</pre></div></div>
</div>
<p>This file now has a name that is meaningful. Looking at the file shows that the chromatogram has been parsed into a simple comma separated format and the relevant metadata has been put into a list of comments at the top of the file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1: #
2: # 2021-03-17_NCM3722_NC_sample004
3: # ------------------------------
4: # Acquired: 3/17/2021 8:51:35 PM
5: # Converted: 16:36 -- 2021-03-25
6: # Vial: 31
7: # Injection Volume: 20 uL
8: # Sample ID: 004
9: #
10: # Detector B
11: # ---------------------
12: # Acquisition Interval: 500 ms
13: # Intensity Units: mV
14: # Intensity Multiplier: 0.001
15: #
16: time_min,intensity_mV,detector
17: 0.0,-5,B
18: 0.008329999999999999,-5,B
</pre></div>
</div>
<p>This shows how the <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc.convert</span></code> can quickly convert the obtuse output from the HPLC software to something that’s easy to read programmatically. There are many other arguments you can pass to chnage the detector channel, save directory, file names, etc. The documentation for the function can be accessed as <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc.convert?</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cremerlab.hplc.convert<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Quantifying-Peaks">
<h2>Quantifying Peaks<a class="headerlink" href="#Quantifying-Peaks" title="Permalink to this headline">¶</a></h2>
<p>With the file converted, we can now try to quantify the chromatogram. Quantification of the peaks involves</p>
<ol class="arabic simple">
<li><p>Loading the chromatogram</p></li>
<li><p>Identifying the location of the peaks, both isolate dand overlapping.</p></li>
<li><p>Inferring the area under the peak and deconvolving overlapping peaks.</p></li>
</ol>
<p>We can start with loading the chromatogram as a <code class="docutils literal notranslate"><span class="pre">cremerlab.hplc.Chromatogram</span></code> object. This is a glorified pandas DataFrame on which we can call several quantification and visualization methods.</p>
<p>To load a chromatogram, we just have to provide the file path to the coverted ASCII file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;data/out/2021-03-17_NCM3722_NC_sample004.csv&#39;</span>
<span class="n">chrom</span> <span class="o">=</span> <span class="n">cremerlab</span><span class="o">.</span><span class="n">hplc</span><span class="o">.</span><span class="n">Chromatogram</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>The chromatogram is now loaded into memory, but typing <code class="docutils literal notranslate"><span class="pre">chrom</span></code> doesn’t provide much information</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chrom</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;cremerlab.hplc.Chromatogram at 0x7f9018c9a880&gt;
</pre></div></div>
</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">chrom</span></code> is assigned to a <code class="docutils literal notranslate"><span class="pre">Chromatogram</span></code> object, which by itself is not useful. To explore the chromatogram, we can can call the <code class="docutils literal notranslate"><span class="pre">show()</span></code> method on the chromatogram, which will plot the intensity as a function of time</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chrom</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;Figure size 576x432 with 1 Axes&gt;,
 &lt;AxesSubplot:xlabel=&#39;time_min&#39;, ylabel=&#39;intensity_mV&#39;&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/source_HPLC_processing_22_1.png" src="../_images/source_HPLC_processing_22_1.png" />
</div>
</div>
<p>There appear to be three strong peaks in the chromatogram, but they all occupy a relatively small portion of the actual trace. We can restrict the time range of the chromatogram by the <code class="docutils literal notranslate"><span class="pre">crop</span></code> method on <code class="docutils literal notranslate"><span class="pre">chrom</span></code>. This method takes a single argument of <code class="docutils literal notranslate"><span class="pre">time_window</span></code> which is a list with the lower and upper time bounds we want to consider. Looking at the above plot, we only care about the information between around 10 and 20 minutes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Crop the chromatogram to consider only a narrow time range</span>
<span class="n">chrom</span><span class="o">.</span><span class="n">crop</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>

<span class="c1"># Plot the chromatogram again to see the new restricted chromatogram</span>
<span class="n">chrom</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;Figure size 576x432 with 1 Axes&gt;,
 &lt;AxesSubplot:xlabel=&#39;time_min&#39;, ylabel=&#39;intensity_mV&#39;&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/source_HPLC_processing_24_1.png" src="../_images/source_HPLC_processing_24_1.png" />
</div>
</div>
<p>Note that after calling the <code class="docutils literal notranslate"><span class="pre">crop</span></code> method, we called the same <code class="docutils literal notranslate"><span class="pre">show</span></code> method that we did earlier. This shows that the chromatogram data in the <code class="docutils literal notranslate"><span class="pre">chrom</span></code> variable how now changed after we called the cropping function.</p>
<p>The three peaks are now clear in the chromatogram, with the latter two overlapping. To properly quantify the area under each peak, we would rather model the overlapping distributions of these peaks rather than drawing a simple threshold at the minimum between them, which is the default integration method in the Shimadzu software.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Chromatogram</span></code> object has a method <code class="docutils literal notranslate"><span class="pre">quantify</span></code>, which detects the peaks, breaks the signal down into peak windows, and infers the mixture function. Aside from fitting the peaks, this function also returns a pandas DataFrame with a list of the peaks, their areas, retention time, and various parameters which define the fitting distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Call the quantification function which returns a peak table.</span>
<span class="n">peak_table</span> <span class="o">=</span> <span class="n">chrom</span><span class="o">.</span><span class="n">quantify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Fitting peak windows...: 100%|██████████| 2/2 [00:01&lt;00:00,  1.70it/s]
</pre></div></div>
</div>
<p>We can show the inferred peak distributions overlaid with the raw chromatogram again by calling the <code class="docutils literal notranslate"><span class="pre">show</span></code> method</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chrom</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;Figure size 576x432 with 1 Axes&gt;,
 &lt;AxesSubplot:xlabel=&#39;time_min&#39;, ylabel=&#39;intensity_mV&#39;&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/source_HPLC_processing_28_1.png" src="../_images/source_HPLC_processing_28_1.png" />
</div>
</div>
<p>Here, the raw chromatogram is shown in solid black, the individual peaks are shown in different colors (blue, orange, and green) and the inferred mixture distribution is shown as a dashed red line. <strong>It’s important to view this fit for each file you process to make sure that it passes the eye test.</strong></p>
<p>We can see the quantification by printing the peak table</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show the quantified peaks</span>
<span class="n">peak_table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>amplitude</th>
      <th>area</th>
      <th>peak_idx</th>
      <th>retention_time</th>
      <th>scale</th>
      <th>skew</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14063.714832</td>
      <td>1.687646e+06</td>
      <td>0</td>
      <td>10.951632</td>
      <td>0.130844</td>
      <td>1.477629</td>
    </tr>
    <tr>
      <th>1</th>
      <td>42681.637267</td>
      <td>5.121699e+06</td>
      <td>1</td>
      <td>15.135356</td>
      <td>0.287974</td>
      <td>-3.569331</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12786.566825</td>
      <td>1.534388e+06</td>
      <td>2</td>
      <td>15.723843</td>
      <td>0.251422</td>
      <td>-1.644769</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.01',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2021, Griffin Chure.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.
        </div>
    </div>  

</body>
</html>